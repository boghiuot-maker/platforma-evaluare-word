<!doctype html>
<html lang="ro">
<head>
  <meta charset="utf-8">
  <title>Panou profesor</title>
  <link rel="stylesheet" href="/static/css/style.css">
  <style>table{border-collapse:collapse;width:100%}th,td{border:1px solid #ddd;padding:6px}</style>
</head>
<body>
  <div class="container">
    <header><h1>Panou profesor</h1></header>
    <main>
<div class="filter-bar" style="margin-bottom:15px; display:flex; gap:12px; align-items:center;">
  <label>Clasa:
    <select id="filterClass">
      <option value="">Toate</option>
      <option>A</option><option>B</option><option>C</option>
      <option>D</option><option>E</option><option>F</option>
    </select>
  </label>

  <label>Data testului:
    <input type="date" id="filterDate">
  </label>

  <button class="btn" id="resetFilters">Reset filtre</button>
</div>

<script>
document.addEventListener("DOMContentLoaded", function() {
  const cls = document.getElementById("filterClass");
  const date = document.getElementById("filterDate");
  const reset = document.getElementById("resetFilters");
  const rows = document.querySelectorAll("table.results tbody tr");

  function applyFilters() {
    let c = cls.value;
    let d = date.value;

    rows.forEach(row => {
      let rClass = row.children[3].innerText.trim();
      let rDate  = row.children[4].innerText.trim();

      let okClass = (!c || rClass === c);
      let okDate  = (!d or rDate === d);

      row.style.display = (okClass && okDate) ? "" : "none";
    });
  }

  cls.addEventListener("change", applyFilters);
  date.addEventListener("change", applyFilters);
  reset.addEventListener("click", function() {
    cls.value = "";
    date.value = "";
    rows.forEach(r => r.style.display = "");
  });
});
</script>

      <p><a class="btn" href="/admin/export/xlsx?pw=profesor">Descarcă XLSX</a> &nbsp; <form method="post" action="/admin/delete_all?pw=profesor" style="display:inline" onsubmit="return confirm('Sigur vrei să ștergi toate rezultatele și fișierele încărcate?');"><button class="btn" type="submit">Șterge toate rezultatele</button></form></p>
      <table class="results">
        <thead><tr><th>#</th><th>Timestamp</th><th>Nume</th><th>Clasa</th><th>Data</th><th>Fisier</th><th>Scor</th><th>Lucrare</th><th>PDF</th></tr></thead>
        <tbody>
        {% for r in records %}
          <tr>
            <td>{{ loop.index }}</td>
            <td>{{ r.timestamp }}</td>
            <td>{{ r.nume_elev }}</td>
            <td>{{ r.clasa }}</td>
            <td>{{ r.data_test }}</td>
            <td>{{ r.fisier }}</td>
            <td>{{ r.scor }} / {{ r.punctaj_maxim }}</td>
            
            <td><a class="btn" href="/uploads/{{ r.fisier }}?pw=profesor">Lucrare</a></td><td><a class="btn" href="/admin/result/{{ r.fisier }}/pdf?pw=profesor">PDF</a></td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
    </main>
  </div>
</body>
</html>
